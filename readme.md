# 1、实验名称：
***socket通讯程序开发实验***

# 2、实验目的：
* 使用一种熟悉的编程语言，开发一个使用Socket 通讯的程序，平台不限(PC或手机均可)
* 程序需要有一定的功能(例如:聊天室、照片分享程序、网络对战五子棋等)，代码要保证原创性。
* 通过此次实验，对计算机网络通信原理的理解，并提升编程实践能力。←

# 3、程序功能：
* 有图形用户界面，基于Tkinter实现。
* 能处理并发请求的服务端，基于threading模块实现。服务端能处理并发请求，每当有客户端请求连接时，服务端都会开启一个线程进行处理，因此当有多个客户端同时请求服务时不会造成阻塞。
* 实现用户名登录功能。用户输入用户名就可以进入到聊天室。
* 公共聊天功能。任何已登录的用户都能在聊天窗口发送消息,且该消息能被其他所有在线用户看到。
* 私人聊天功能。所有已登录的用户都显示在在线用户列表中,用户可以通过规定的私聊信息格式进行私聊。←

# 4、服务端讲解
## 4.1服务端逻辑流程
### 版本1
```mermaid
flowchart TD
    A[启动服务器] --> B[创建套接字并绑定]
    B --> C[监听连接请求]
    C --> D{收到连接请求？}
    D -->|Yes| E[接受连接]
    E --> F[创建新线程处理客户端]
    F --> G[返回监听状态]
    D -->|No| H[继续监听]

    subgraph 客户端处理
        I[接收用户名] --> J{用户名有效？}
        J -->|No| K[关闭连接]
        J -->|Yes| L[添加客户端到在线用户列表]
        L --> M[打印加入信息]
        M --> N[广播加入信息]
        N --> O[广播在线用户列表]
        O --> P[循环接收消息]
        P --> Q{消息是私聊？}
        Q -->|Yes| R[处理私聊消息]
        Q -->|No| S[广播群聊消息]
        P --> T{连接异常？}
        T -->|Yes| U[关闭连接]
        U --> V[删除客户端]
        V --> W[打印离开信息]
        W --> X[广播离开信息]
        X --> Y[广播在线用户列表]
        T -->|No| P
    end
```
### 版本2
```mermaid
flowchart TD
    A[启动服务器] --> B[创建套接字]
    B --> C[绑定主机和端口]
    C --> D[监听连接请求]
    D --> E[循环接收客户端连接请求]
    E --> F[接受客户端连接]
    F --> G[创建新线程处理客户端连接请求]
    G --> H[处理客户端连接]

    subgraph 处理客户端连接
        H --> I[接收客户端发送的用户名]
        I --> J{用户名为空？}
        J -->|Yes| K[关闭连接，返回]
        J -->|No| L[添加新客户端到在线用户字典]
        L --> M[打印客户端加入信息]
        M --> N[广播新用户加入信息]
        N --> O[广播在线用户列表]
        O --> P[循环接收客户端发送的消息]
        P --> Q{消息为私聊？}
        Q -->|Yes| R[解析私聊消息]
        R --> S{目标用户在线？}
        S -->|Yes| T[发送私聊消息]
        S -->|No| U[发送目标用户不在线的信息]
        Q -->|No| V[广播群聊消息]
        P --> W{客户端断开连接？}
        W -->|Yes| X[关闭连接]
        X --> Y[删除在线用户字典中的客户端]
        Y --> Z[打印客户端离开信息]
        Z --> AA[广播客户端离开信息]
        AA --> AB[广播在线用户列表]
    end
```






# 5、客户端讲解
## 5.1客户端逻辑流程
```mermaid
flowchart TD
    A[启动客户端] --> B[显示登录界面]
    B --> C[输入用户名并点击登录]
    C --> D{连接服务器成功？}
    D -->|是| E[发送用户名]
    D -->|否| F[显示连接失败信息]
    E --> G[隐藏登录界面]
    E --> H[显示聊天界面]
    E --> I[启动接收消息线程]
    H --> J[输入消息并点击发送]
    J --> K[发送消息到服务器]
    K --> L[更新聊天窗口]
    I --> M[接收消息]
    M --> N{消息类型？}
    N -->|在线用户列表| O[更新在线用户列表]
    N -->|普通消息| P[更新聊天窗口]
    P --> M
    O --> M
```








# 6、参考资料
* [菜鸟教程：Python网络编程](https://www.runoob.com/python/python-socket.html)
* [菜鸟教程：Python多线程](https://www.runoob.com/python/python-multithreading.html)
* [菜鸟教程：Python GUI编程 Tkinter](https://www.runoob.com/python/python-gui-tkinter.html)


  
